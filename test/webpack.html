<!DOCTYPE html>
<html>
<head>
  <title>discord.js Webpack test</title>
  <meta charset="utf-8" />
</head>
<body>
  <script type="text/javascript" src="../webpack/discord.11.0.0.js"></script>
  <script type="text/javascript" src="auth.js"></script>
  <script type="text/javascript">
    (() => {
      const start = Date.now();
      const log = (...args) => console.log(...args);

      const client = window.client = new Discord.Client({
        disabledEvents: ['TYPING_START', 'PRESENCE_UPDATE'],
        sync: true,
        fetchAllUsers: true,
        apiRequestMethod: 'sequential',
        shardCount: 0,
      });

      client.on('debug', log.bind(null, '[DEBUG]'));
      client.on('error', log.bind(null, '[CLIENT ERROR]'));
      client.ws.on('close', (event, shardID) => log('[WS CLOSE]', event.code, shardID));

      client.on('ready', () => log('[CLIENT READY]', client.user.username, client.user.id));
      client.on('resume', (replayed, id) => log('[CLIENT RESUME]', replayed.toString(), id.toString()));

      client.login(localStorage.token || window.token || prompt('token pls', 'abcdef123456'))
      .then((token) => {
        localStorage.token = token;
      }).catch((err) => {
        console.log(err);
        localStorage.token = null;
      });
    })();
  </script>
</body>
</html>
